services:
  mcl:
    image: kagurazakanyaa/mcl:${IMAGE_TAG:-latest}
    restart: unless-stopped
    tty: true
    stdin_open: true
    volumes:
      # Public Files
      - ${MNT_DIR:-/mnt/docker}/mcl/libs:/app/libs
      - ${MNT_DIR:-/mnt/docker}/mcl/plugins:/app/plugins
      - ${MNT_DIR:-/mnt/docker}/mcl/ANDROID_PAD.json:/app/ANDROID_PAD.json
      - ${MNT_DIR:-/mnt/docker}/mcl/ANDROID_PAD.json:/app/android_pad.json
      - ${MNT_DIR:-/mnt/docker}/mcl/KFCFactory.json:/app/KFCFactory.json
      # Bots Files
      - ${MNT_DIR:-/mnt/docker}/mcl/configs/${BOTS_DIR:-temp}/bots:/app/bots
      - ${MNT_DIR:-/mnt/docker}/mcl/configs/${BOTS_DIR:-temp}/config/Console/AutoLogin.yml:/app/config/Console/AutoLogin.yml
      - ${MNT_DIR:-/mnt/docker}/mcl/configs/${BOTS_DIR:-temp}/config/net.mamoe.mirai-api-http/setting.yml:/app/config/net.mamoe.mirai-api-http/setting.yml
      - ${MNT_DIR:-/mnt/docker}/mcl/configs/${BOTS_DIR:-temp}/logs:/app/logs
    environment:
      - "JAVA_OPTS=-Dmirai.slider.captcha.supported -Dmirai.console.skip-end-user-readme"
    deploy:
      resources:
        limits:
          memory: ${RESOURCES_LIMITS_MEMORY}
          ports:
            - ${PORT}:8080
          labels:
            # watchtower
            - com.centurylinklabs.watchtower.enable=${WATCHTOWER_ENABLE:-true}
    networks:
      - web

networks:
  web:
    external: true
